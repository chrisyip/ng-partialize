{"version":3,"file":"dist/ng-partialize.min.js","sources":["index.js"],"names":["angular","Error","getDeps","$injector","$scope","factoryFunction","annotation","annotate","deps","forEach","name","push","get","controllerWrapper","module","context","factory","isFunction","before","_beforeControllers","isArray","apply","after","_afterControllers","registerController","type","collection","Object","defineProperty","value","_Module","_ngPartialized","defineProperties","_Controller","controller","beforeController","this","afterController","Function"],"mappings":";;;;;;CAMC,SAAWA,SACV,IAAKA,QAAS,CACZ,KAAM,IAAIC,OAAM,wEAGlB,QAASC,SAASC,UAAWC,OAAQC,iBACnC,GAAIC,YAAaH,UAAUI,SAASF,gBACpC,IAAIG,QAEJR,SAAQS,QAAQH,WAAY,SAAUI,MACpC,GAAIA,OAAS,SAAU,CACrBF,KAAKG,KAAKP,YACL,CACLI,KAAKG,KAAKR,UAAUS,IAAIF,SAI5B,OAAOF,MAGT,QAASK,mBAAmBC,OAAQJ,KAAMK,QAASV,iBACjD,GAAIW,UAAW,YAAa,SAE5B,IAAIhB,QAAQiB,WAAWZ,iBAAkB,CACvCW,QAAQL,KAAK,SAAUR,UAAWC,QAChC,GAAIc,QAASJ,OAAOK,mBAAmBT,KAEvC,IAAIV,QAAQoB,QAAQF,QAAS,CAC3BlB,QAAQS,QAAQS,OAAQ,SAAUF,SAChCA,QAAQK,MAAMN,QAASb,QAAQC,UAAWC,OAAQY,YAItDX,gBAAgBgB,MAAMN,QAASb,QAAQC,UAAWC,OAAQC,iBAE1D,IAAIiB,OAAQR,OAAOS,kBAAkBb,KAErC,IAAIV,QAAQoB,QAAQE,OAAQ,CAC1BtB,QAAQS,QAAQa,MAAO,SAAUN,SAC/BA,QAAQK,MAAMN,QAASb,QAAQC,UAAWC,OAAQY,eAM1D,MAAOA,SAGT,QAASQ,oBAAoBV,OAAQW,KAAMf,KAAML,iBAC/C,GAAIqB,YAAaZ,OAAOW,KAExB,IAAIzB,QAAQoB,QAAQM,WAAWhB,OAAQ,CACrCgB,WAAWhB,MAAMC,KAAKN,qBACjB,CACLqB,WAAWhB,OAASL,iBAGtB,MAAOS,QAGTa,OAAOC,eAAe5B,QAAS,WAC7B6B,MAAO7B,QAAQc,QAGjBd,SAAQc,OAAS,SAAUJ,KAAMF,MAC/B,GAAIM,QAASd,QAAQ8B,QAAQpB,KAAMF,KAEnC,KAAKM,OAAOiB,eAAgB,CAC1BJ,OAAOK,iBAAiBlB,QACtBK,oBAAsBU,UAEtBN,mBAAqBM,UAErBI,aACEJ,MAAOf,OAAOoB,YAGhBH,gBACEF,MAAO,OAIXf,QAAOqB,iBAAmB,SAAUzB,KAAML,iBACxC,MAAOmB,oBAAmBY,KAAM,qBAAsB1B,KAAML,iBAG9DS,QAAOuB,gBAAkB,SAAU3B,KAAML,iBACvC,MAAOmB,oBAAmBY,KAAM,oBAAqB1B,KAAML,iBAG7DS,QAAOoB,WAAa,SAAUxB,KAAML,iBAClC+B,KAAKjB,mBAAmBT,QACxB0B,MAAKb,kBAAkBb,QACvB0B,MAAKH,YAAYvB,KAAMG,kBAAkBuB,KAAM1B,KAAM0B,KAAM/B,iBAE3D,OAAO+B,OAIX,MAAOtB,UAER,GAAIwB,UAAS","sourcesContent":["/**\n * ng-partialize\n * @author Chris Yip i@chrisyip.im\n * @website https://github.com/chrisyip/ng-partialize\n * @license MIT\n */\n!(function (angular) {\n  if (!angular) {\n    throw new Error('Cannot found angular, make sure angular is attached to global object')\n  }\n\n  function getDeps ($injector, $scope, factoryFunction) {\n    var annotation = $injector.annotate(factoryFunction)\n    var deps = []\n\n    angular.forEach(annotation, function (name) {\n      if (name === '$scope') {\n        deps.push($scope)\n      } else {\n        deps.push($injector.get(name))\n      }\n    })\n\n    return deps\n  }\n\n  function controllerWrapper (module, name, context, factoryFunction) {\n    var factory = ['$injector', '$scope']\n\n    if (angular.isFunction(factoryFunction)) {\n      factory.push(function ($injector, $scope) {\n        var before = module._beforeControllers[name]\n\n        if (angular.isArray(before)) {\n          angular.forEach(before, function (factory) {\n            factory.apply(context, getDeps($injector, $scope, factory))\n          })\n        }\n\n        factoryFunction.apply(context, getDeps($injector, $scope, factoryFunction))\n\n        var after = module._afterControllers[name]\n\n        if (angular.isArray(after)) {\n          angular.forEach(after, function (factory) {\n            factory.apply(context, getDeps($injector, $scope, factory))\n          })\n        }\n      })\n    }\n\n    return factory\n  }\n\n  function registerController (module, type, name, factoryFunction) {\n    var collection = module[type]\n\n    if (angular.isArray(collection[name])) {\n      collection[name].push(factoryFunction)\n    } else {\n      collection[name] = [factoryFunction]\n    }\n\n    return module\n  }\n\n  Object.defineProperty(angular, '_Module', {\n    value: angular.module\n  })\n\n  angular.module = function (name, deps) {\n    var module = angular._Module(name, deps)\n\n    if (!module._ngPartialized) {\n      Object.defineProperties(module, {\n        _beforeControllers: { value: {} },\n\n        _afterControllers: { value: {} },\n\n        _Controller: {\n          value: module.controller\n        },\n\n        _ngPartialized: {\n          value: true\n        }\n      })\n\n      module.beforeController = function (name, factoryFunction) {\n        return registerController(this, '_beforeControllers', name, factoryFunction)\n      }\n\n      module.afterController = function (name, factoryFunction) {\n        return registerController(this, '_afterControllers', name, factoryFunction)\n      }\n\n      module.controller = function (name, factoryFunction) {\n        this._beforeControllers[name] = []\n        this._afterControllers[name] = []\n        this._Controller(name, controllerWrapper(this, name, this, factoryFunction))\n\n        return this\n      }\n    }\n\n    return module\n  }\n})(new Function('return this.angular')())\n"]}